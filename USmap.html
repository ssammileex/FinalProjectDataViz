<!DOCTYPE html>
<!--
  Course: DATA 300L 111 Spring 2018
  Author: Samantha Errico and Allison Moshier
  Email: Samantha.errico1@marist.edu
  CWID: 200-57-156
  Assignment: 5
-->
<html lang="en">
<head>
  <meta charset="utf-8"/>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <title>US MAP</title>
</head>

<body>
<h1  id="titlePage">Map!!</h1>

	<script>
		
		//Define height and width
		var h = 500;
		var w = 800;

		//define projection
		var projection = d3.geoAlbersUsa()
							.translate([w/2, h/2])
							.scale([1000]);


		//define path
		var path = d3.geoPath()
					 .projection(projection);

		//create color gradient
		var color = d3.scaleQuantize()
					  .range(["blue", "white", "pink", "green", "grey"]);

		d3.csv("us-crime2.csv", function(data){
			
			var max = d3.max(data, function(d) { return d.Total.replace(/,/g,''); });
			var min = d3.min(data, function(d) { return d.Total.replace(/,/g,''); });
			console.log(max);
			console.log(min);

		d3.json("us-states.json", function(json){
		  for(var i = 0; i < data.length; i++){
		  	var dataState = data[i].State;
		  	var dataTotal = parseFloat(data[i].Total.replace(/,/g, ''));
		


		  	for(var j = 0; j < json.features.length; j++){
		  		var jsonState = json.features[j].properties.name;
		  			if(dataState == jsonState){

		  				json.features[j].properties.Total = dataTotal;
		  				break;
		  			}
		  	}

		  }

		  	
		  
		  //Create SVG element
          var svg = d3.select("body")
                .append("svg")
                .attr("width", w)
                .attr("height", h);


			svg.selectAll("path")
				.data(json.features)
				.enter()
				.append("path")
				.attr("d", path)
				.style("fill", function(d){
					var value = d.properties.Total;
						if(value){
							console.log(value);
							return color(value);
						}else{
							return "black";
						}
					});

			svg.selectAll("path")
				.data(json.features)
				.enter()
				.append("path")
				.attr("d", path);

		});
	});

	</script>

</body>
</html>

